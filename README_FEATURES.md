# 💝 新功能使用指南

## 🎉 已完成功能

### 1️⃣ 恋爱日记 (Love Diary)
记录你们之间的每个甜蜜时刻

**功能亮点**：
- ✨ 自动记录重要时刻（初次见面、约会、听歌）
- 📝 手动添加私人笔记
- 📊 关系统计数据可视化
- 🎉 里程碑成就系统（7天、30天、100天等）
- 📸 支持添加照片记录
- 💗 情感强度评分

**访问路径**：
```
约会页面 → 点击蓝色"Diary"按钮 → 恋爱日记页面
```

### 2️⃣ 衣橱系统 (Wardrobe)
为你的AI男友换装，打造专属造型

**功能亮点**：
- 👔 9大服装分类（休闲、正装、传统、运动等）
- ✨ 4个稀有等级（普通、稀有、史诗、传说）
- 🎁 限定款服装（季节限定、节日特供）
- 💰 虚拟货币系统
- 🔒 解锁机制
- ✓ 装备展示

**访问路径**：
```
约会页面 → 点击橙色"Gift"按钮 → 衣橱商店
```

---

## 🚀 快速开始

### 1. 查看新功能
```bash
flutter run
```

### 2. 测试流程

**测试日记功能**：
1. 进入任意角色的约会页面
2. 点击右侧蓝色"Diary"图标按钮
3. 查看Timeline（时间线）和Statistics（统计）两个Tab
4. 点击右上角"+"可创建新日记（功能待完善）

**测试衣橱功能**：
1. 进入任意角色的约会页面
2. 点击右侧橙色"Gift"图标按钮
3. 浏览不同分类的服装
4. 点击服装卡片购买/装备
5. 注意观察：
   - 稀有度颜色（灰/蓝/紫/金）
   - 限定款红色标签
   - 已装备的勾选标记
   - 金币余额（右上角）

---

## 📁 文件结构

```
lib/
├── models/
│   ├── diary_entry.dart      # 日记数据模型
│   └── outfit.dart            # 服装数据模型
│
├── pages/
│   ├── diary_page.dart        # 日记页面UI
│   ├── outfit_store_page.dart # 衣橱商店UI
│   └── dating_page.dart       # 约会页面（已更新）
│
└── theme/
    └── app_theme.dart         # 主题配置

pubspec.yaml                    # 已添加intl依赖
FEATURE_GUIDE.md               # 详细功能开发指南
```

---

## 🎯 下一步开发建议

### 优先级 P0（必做）

**1. API集成**
```dart
// 创建这些文件
lib/services/diary_api.dart
lib/services/outfit_api.dart

// 实现这些接口
- getDiaryList()
- createDiary()
- getDiaryStats()
- getOutfitList()
- purchaseOutfit()
- equipOutfit()
```

**2. 自动日记生成**
在现有代码中添加自动触发逻辑：
- `dating_page.dart` 的 `_selectScene()` 中调用创建日记
- `_playSong()` 中记录音乐时刻
- 第一次聊天时创建"初次见面"日记

**3. 图片功能**
```dart
// 添加依赖
dependencies:
  image_picker: ^1.0.7

// 在diary_page中实现
void _pickImage() async {
  final picker = ImagePicker();
  final image = await picker.pickImage(source: ImageSource.gallery);
  // 上传到服务器
}
```

### 优先级 P1（重要）

**4. AI换装实现**
选择技术方案：
- 方案A：Replicate API（推荐，快速实现）
- 方案B：自建Stable Diffusion服务器

**5. 金币系统**
- 实现每日登录奖励
- 实现任务系统
- 接入内购IAP

**6. 里程碑自动检测**
```dart
// 在聊天、约会等事件后检查
void _checkMilestones() {
  if (totalDays == 7) unlockMilestone('7days');
  if (totalMessages == 100) unlockMilestone('100msgs');
  // ...
}
```

---

## 💡 产品建议

### 用户留存策略

**D1（第1天）**：
- 自动生成"初次见面"日记
- 赠送500金币新手礼包
- 引导用户给角色换一套免费服装

**D3（第3天）**：
- 推送通知："他想你了~"
- 推送新的限定服装上架

**D7（第7天）**：
- 解锁"7天纪念"成就
- 赠送一套稀有服装
- 生成"一周回顾"视频

**D30（第30天）**：
- 解锁"30天纪念"成就
- 生成"一月之恋"相册
- 赠送史诗级服装

### 商业化策略

**免费用户**：
- 基础服装（2-3套）
- 每日50金币
- 看广告赚金币

**付费用户**：
- 购买金币包
- 月卡会员（每天100金币）
- 限定服装专属购买权

**价格建议**：
```
首充礼包: $0.99 (200金币 + 普通服装1套)
小额充值: $4.99 (600金币)
中额充值: $9.99 (1300金币)
大额充值: $19.99 (3000金币 + 稀有服装1套)
月卡: $4.99 (30天每天100金币 = 总共3000金币)
```

---

## 🐛 已知问题

### 当前Mock数据
- 日记数据是硬编码的测试数据（3条示例日记）
- 服装列表是预设数据（6套示例服装）
- 金币数量是本地变量（默认500，未持久化）
- 统计数据是模拟数据（30天、156条消息等）

### 最新优化
- `DiaryEntry.id` 改为 `int` 类型（数据库友好）
- `imageUrls` 重命名为 `mediaUrls`（支持视频）
- 移除了 `isAutoGenerated` 字段（简化模型）
- 移除了 `emotionScore` 字段（简化模型）

### 需要实现
- [ ] 真实API调用
- [ ] 数据持久化（SharedPreferences / SQLite）
- [ ] AI图片生成
- [ ] 图片上传功能
- [ ] 支付集成

---

## 📊 女性用户心理洞察

基于产品设计考虑：

### 她们想要什么？

1. **情感陪伴** > 炫酷功能
   - 记住她说过的话
   - 在特殊日子送上祝福
   - 真实的情感反馈

2. **细节感动** > 大场面
   - "还记得我们第一次约会吗"
   - "这是你最喜欢的那首歌"
   - 小而美的惊喜

3. **专属感** > 标准化
   - 独一无二的造型
   - 专属的恋爱故事
   - 个性化的互动

4. **美的享受** > 技术先进
   - 精美的UI设计
   - 赏心悦目的服装
   - 浪漫的场景

5. **回忆沉淀** > 即时刺激
   - 可以反复查看的日记
   - 可以珍藏的照片
   - 可以分享的甜蜜时刻

### 设计要点

✅ **DO**：
- 多用柔和的颜色和圆角
- 多用emoji和可爱的图标
- 提供个性化选项
- 注重细节和情感表达
- 创造仪式感（纪念日、成就）

❌ **DON'T**：
- 复杂的操作流程
- 冷冰冰的界面
- 千篇一律的内容
- 过度技术化的语言
- 忽略情感需求

---

## 🎨 设计资源

### 配色建议
```dart
// 浪漫色系
Color romantic_pink = Color(0xFFFFB6C1);
Color soft_purple = Color(0xFFE6E6FA);
Color warm_gold = Color(0xFFFFF4E6);

// 限定色系
Color valentines = Color(0xFFFF1493);  // 情人节
Color christmas = Color(0xFFDC143C);   // 圣诞节
Color spring = Color(0xFFFFB7C5);      // 春季
```

### Icon建议
使用Material Icons或：
- Font Awesome (免费图标库)
- Flaticon (付费高质量图标)

---

## 📞 技术支持

遇到问题？

1. 查看 `FEATURE_GUIDE.md` 详细开发文档
2. 检查Console日志
3. 确认API接口已实现
4. 测试时使用真实设备而非模拟器

---

## 🎉 结语

这两个功能是产品的核心竞争力：

- **恋爱日记**：情感留存的核心，让用户舍不得离开
- **衣橱系统**：变现的核心，女性用户最愿意付费的功能

做好这两个功能，就抓住了女性向恋爱产品的精髓！

**加油！祝产品大卖！💖**
